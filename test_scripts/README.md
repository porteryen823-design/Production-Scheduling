# 自動化測試系統說明

## 概述

本系統提供完整的自動化測試功能，可以自動執行以下流程：

1. **清空測試資料** - 清除資料庫中的所有測試資料
2. **產生 Lot** - 根據配置產生指定數量的 Lot，批量隨機設定
3. **重新排程** - 執行排程演算法
4. **模擬時鐘** - 模擬生產過程
5. **重複循環** - 重複步驟 2-4 共 N 次

## 目錄結構

```
APS01/
├── test_scripts/              # 測試腳本目錄
│   ├── test_config_01.json    # 基本測試配置
│   ├── test_config_02.json    # 中等測試配置
│   ├── test_config_03.json    # 壓力測試配置
│   ├── test_config_04.json    # 快速測試配置
│   ├── test_config_05.json    # 小批量測試配置
│   ├── test_config_06.json    # 大批量測試配置
│   ├── test_config_07.json    # 長時間測試配置
│   ├── test_config_08.json    # 混合批量測試配置
│   ├── test_config_09.json    # 高頻測試配置
│   └── test_config_10.json    # 極限測試配置
├── automated_test_runner.py   # 自動化測試執行器
└── QtQui/
    └── qt_gui.py              # GUI 主程式（含自動化測試分頁）
```

## 測試配置檔案格式

每個測試配置檔案都是 JSON 格式，包含以下欄位：

```json
{
  "name": "測試名稱",
  "description": "測試描述",
  "cycles": 5,                    // 循環次數
  "lots_per_cycle": 3,            // 每次循環產生的 Lot 數量
  "lot_quantity_min": 1,          // Lot 批量最小值
  "lot_quantity_max": 4,          // Lot 批量最大值
  "simulation_iterations": 50,    // 模擬次數
  "simulation_timedelta": 60      // 時間增量（秒）
}
```

## 使用方式

### 方法一：使用 GUI（推薦）

1. 啟動 GUI 程式：
   ```bash
   python QtQui/qt_gui.py
   ```

2. 切換到「自動化測試」分頁

3. 從列表中選擇測試腳本

4. 查看測試配置詳情

5. 點擊「▶️ 執行測試」按鈕

6. 確認執行（會清空所有測試資料）

7. 等待測試完成，可隨時點擊「⏹️ 停止測試」中斷執行

### 方法二：使用命令列

```bash
python automated_test_runner.py --config test_scripts/test_config_01.json
```

## 測試腳本說明

### test_config_01.json - 基本測試
- **循環次數**：5 次
- **每次產生 Lot 數**：3 個
- **批量範圍**：1-4
- **總 Lot 數**：15 個
- **適用場景**：基本功能驗證

### test_config_02.json - 中等測試
- **循環次數**：10 次
- **每次產生 Lot 數**：5 個
- **批量範圍**：1-4
- **總 Lot 數**：50 個
- **適用場景**：中等強度測試

### test_config_03.json - 壓力測試
- **循環次數**：20 次
- **每次產生 Lot 數**：10 個
- **批量範圍**：1-4
- **總 Lot 數**：200 個
- **適用場景**：系統壓力測試

### test_config_04.json - 快速測試
- **循環次數**：3 次
- **每次產生 Lot 數**：2 個
- **批量範圍**：1-4
- **總 Lot 數**：6 個
- **適用場景**：快速驗證功能

### test_config_05.json - 小批量測試
- **循環次數**：8 次
- **每次產生 Lot 數**：1 個
- **批量範圍**：1（固定）
- **總 Lot 數**：8 個
- **適用場景**：小批量生產模擬

### test_config_06.json - 大批量測試
- **循環次數**：5 次
- **每次產生 Lot 數**：8 個
- **批量範圍**：2-4
- **總 Lot 數**：40 個
- **適用場景**：大批量生產模擬

### test_config_07.json - 長時間測試
- **循環次數**：15 次
- **每次產生 Lot 數**：6 個
- **批量範圍**：1-4
- **總 Lot 數**：90 個
- **模擬時間增量**：120 秒
- **適用場景**：長時間運行測試

### test_config_08.json - 混合批量測試
- **循環次數**：12 次
- **每次產生 Lot 數**：4 個
- **批量範圍**：1-4
- **總 Lot 數**：48 個
- **適用場景**：混合批量模擬

### test_config_09.json - 高頻測試
- **循環次數**：25 次
- **每次產生 Lot 數**：3 個
- **批量範圍**：1-3
- **總 Lot 數**：75 個
- **模擬時間增量**：45 秒
- **適用場景**：高頻率生產模擬

### test_config_10.json - 極限測試
- **循環次數**：30 次
- **每次產生 Lot 數**：7 個
- **批量範圍**：1-4
- **總 Lot 數**：210 個
- **適用場景**：極限壓力測試

## 自訂測試配置

您可以建立自己的測試配置檔案：

1. 在 `test_scripts/` 目錄下建立新的 JSON 檔案
2. 按照上述格式填寫配置
3. 在 GUI 中點擊「🔄 重新載入腳本」
4. 選擇新建立的測試腳本執行

## 測試結果

測試執行過程中會即時顯示：
- ✅ 成功的步驟
- ❌ 失敗的步驟
- 📊 統計資訊
- 🔄 循環進度

測試完成後會顯示：
- 總循環數
- 總產生 Lot 數
- 執行狀態

## 注意事項

1. **資料清空**：執行測試前會清空所有測試資料，請確認資料庫中沒有重要資料
2. **執行時間**：根據配置不同，測試可能需要較長時間執行
3. **資源使用**：大型測試（如極限測試）會消耗較多系統資源
4. **中斷測試**：可隨時點擊「停止測試」按鈕中斷執行

## 故障排除

### 問題：找不到測試腳本
**解決方案**：確認 `test_scripts/` 目錄存在且包含 JSON 配置檔案

### 問題：測試執行失敗
**解決方案**：
1. 檢查資料庫連線是否正常
2. 確認相關 Python 腳本存在
3. 查看錯誤訊息進行除錯

### 問題：測試卡住不動
**解決方案**：
1. 點擊「停止測試」按鈕
2. 檢查資料庫狀態
3. 重新啟動 GUI 程式

## 技術支援

如有問題，請聯繫開發團隊。
